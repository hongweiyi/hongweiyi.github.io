<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Shell常用命令 终端优化前篇 · 小e的笔记</title><meta name="description" content="Shell常用命令 终端优化前篇 - Hongwei Yi"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/tags" target="_self" class="nav-list-link">TAGS</a></li><li class="nav-list-item"><a href="http://weibo.com/1674333040" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://twitter.com/hongwei89" target="_blank" class="nav-list-link">TWITTER</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Shell常用命令 终端优化前篇</h1><div class="post-meta"><div class="post-time">Jan 17, 2013 | [<a class="tag-link" href="/tags/Linux/">Linux</a>, <a class="tag-link" href="/tags/Shell/">Shell</a>]</div></div><div class="post-content"><p>在黑框框shell下作业也一年多了，其中实战占了9个月，从最开始的翻阅各种书籍，到后面问谷歌，也算是能熟练“掌握”这门工具，也搜集了一些“奇技淫巧”。现在好好的总结一下吧，顺带也查漏补缺……</p>
<a id="more"></a>
<h3 id="1-1_终端设置">1.1 终端设置</h3><p>下载一个好用的终端，如<a href="http://www.netsarang.com/products/xsh_overview.html" target="_blank" rel="external">xshell</a>，<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" target="_blank" rel="external">putty</a>。</p>
<p>设置Encoding、Terminal Type，一般来说在终端中设置一下即可。Encoding为utf8，Terminal Type设置为xterm、VT100、linux都可以，设置其他的类型有的可能ls文件会没有颜色（这个情况在screen命令中也会出现，到时候再讲解决方案吧），或者Home/End键不好用（代替快捷键：Ctrl+a/e）之类的。</p>
<h4 id="1-2_shell提示符设置">1.2 shell提示符设置</h4><p>终端提示符默认的就是白色的用户名，看着非常不舒服，可以设置一下当前环境的提示符颜色，变量是PS1：</p>
<p><img src="http://hongweiyi.com/wp-content/uploads/2013/01/image.png" alt="image"></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; $ echo $PS1</span><br><span class="line">[\e[<span class="number">31</span>;<span class="number">1</span>m]\u[\e[<span class="number">0</span>m]@[\e[<span class="number">32</span>;<span class="number">1</span>m]your ip[\e[<span class="number">0</span>m]:[\e[<span class="number">35</span>;<span class="number">1</span>m]\w[\e[<span class="number">0</span>m]\$</span><br></pre></td></tr></table></figure>
<p>你也可以不填写ip，用命令获得当前ip：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; <span class="formula">$ export PS1="<span class="special">[</span><span class="command">\e</span><span class="special">[</span>31;1m<span class="special">]</span><span class="command">\u</span><span class="special">[</span><span class="command">\e</span><span class="special">[</span>0m<span class="special">]</span>@<span class="special">[</span><span class="command">\e</span><span class="special">[</span>32;1m<span class="special">]</span>/sbin/ifconfig eth1|grep "inet<span class="special">&amp;</span>nbsp;<span class="special">&amp;</span>nbsp; addr:"|cut -d: -f 2|cut -d" " -f1<span class="special">[</span><span class="command">\e</span><span class="special">[</span>0m<span class="special">]</span>:<span class="special">[</span><span class="command">\e</span><span class="special">[</span>35;1m<span class="special">]</span><span class="command">\w</span><span class="special">[</span><span class="command">\e</span><span class="special">[</span>0m<span class="special">]</span><span class="command">\$</span> "</span></span><br></pre></td></tr></table></figure>
<p>其他颜色可参考：<a href="http://unix-cd.com/unixcd12/article_7281.html" target="_blank" rel="external">Linux终端下的颜色设置</a></p>
<p>上面的PS1变量可以设置在用户配置中，文件为~/.bashrc，在该文件中添加一行：<code>export PS1=</code>即可。如果再次登陆的时候，该命令没有生效，则添加~/.bash_profile文件，当shell被打开时，该文件会被执行一次。在文件中添加命令即可加载~/.bashrc：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Get the aliases and functions</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="operator">-f</span> ~/.bashrc ]; <span class="keyword">then</span></span><br><span class="line">    . ~/.bashrc</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>
<p>如果你想该文件立即生效，可以用source ~/.bashrc命令立即加载执行该文件。</p>
<h4 id="1-3_别名设置">1.3 别名设置</h4><p>可以用一些简单的别名代替一些复杂的命令，如下：</p>
<figure class="highlight monkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alias</span> ..=<span class="string">"cd .."</span></span><br><span class="line"><span class="keyword">alias</span> …=<span class="string">"cd ../.."</span></span><br><span class="line"><span class="keyword">alias</span> <span class="title">cd</span>..=<span class="string">"cd .."</span></span><br><span class="line"><span class="keyword">alias</span> <span class="title">ll</span>=<span class="string">"ls -l"</span></span><br><span class="line"><span class="keyword">alias</span> <span class="title">la</span>=<span class="string">"ls -a"</span></span><br><span class="line"><span class="keyword">alias</span> <span class="title">tree</span>=<span class="string">"~/code/tree"</span></span><br></pre></td></tr></table></figure>
<p>将alias添加进~/.bashrc中。~/code/tree是一个shell脚本，脚本内容如下：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/<span class="keyword">sh</span></span><br><span class="line">function tree_files()</span><br><span class="line">&#123;</span><br><span class="line">    find . -<span class="keyword">print</span> 2&gt;/dev/null|\</span><br><span class="line">    awk '!/\.$/ &#123;<span class="keyword">for</span> (i=1;i&lt;NF;i++)&#123;\</span><br><span class="line">    <span class="keyword">d</span>=<span class="literal">length</span>(<span class="label">$i</span>);<span class="keyword">if</span> ( <span class="keyword">d</span> &lt; 5 &amp;&amp; i != 1 )<span class="keyword">d</span>=5;printf(<span class="string">"%"</span><span class="keyword">d</span><span class="string">"s"</span>,<span class="string">"|"</span>)&#125;<span class="keyword">print</span> <span class="string">"—"</span><span class="label">$NF&#125;</span>' \</span><br><span class="line">    FS='/' | <span class="keyword">more</span></span><br><span class="line">&#125;</span><br><span class="line">function tree_dirs()</span><br><span class="line">&#123;</span><br><span class="line">    find . -<span class="keyword">type</span> <span class="keyword">d</span> -<span class="keyword">print</span> 2&gt;/dev/null|\</span><br><span class="line">    awk '!/\.$/ &#123;<span class="keyword">for</span> (i=1;i&lt;NF;i++)&#123;\</span><br><span class="line">    <span class="keyword">d</span>=<span class="literal">length</span>(<span class="label">$i</span>);<span class="keyword">if</span> ( <span class="keyword">d</span> &lt; 5 &amp;&amp; i != 1 )<span class="keyword">d</span>=5;printf(<span class="string">"%"</span><span class="keyword">d</span><span class="string">"s"</span>,<span class="string">"|"</span>)&#125;<span class="keyword">print</span> <span class="string">"—"</span><span class="label">$NF&#125;</span>' \</span><br><span class="line">    FS='/' | <span class="keyword">more</span></span><br><span class="line">&#125;</span><br><span class="line">function <span class="keyword">help</span>()</span><br><span class="line">&#123;</span><br><span class="line">    echo <span class="string">"Usage: tree [-f|-d]"</span></span><br><span class="line">    echo <span class="string">"  -f: list files of current directory"</span></span><br><span class="line">    echo <span class="string">"  -d: list direcotries of current directory"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> [ $# = 0 ]; then</span><br><span class="line">    tree_dirs</span><br><span class="line">elif [ $# = 1 ]; then</span><br><span class="line">    <span class="keyword">if</span> [ <span class="label">$1</span> = “-f” ]; then</span><br><span class="line">        tree_files</span><br><span class="line">    elif [ <span class="label">$1</span> = “-<span class="keyword">d</span>” ]; then</span><br><span class="line">        tree_dirs</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">help</span></span><br><span class="line">    fi</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
<h3 id="1-4_文档编辑器设置">1.4 文档编辑器设置</h3><p>我用的是vim，配置文件为~/.vimrc。由于工作机较多，所以没有一个个去配置，不可缺少的是syntax on（开启高亮），indent都没太大必要了。当然，专用开发机需要配置一个比较好用的，因人而异，如需要较好配置文件的可自行谷歌。</p>
<p>有了以上四步，基本上一个简单方便好用的终端就有了，接下来我会一一介绍常用的shell命令：文件/目录操作、输入/输出操作、文本操作、进程操作等。</p>
<blockquote>
<p>个人不太喜欢装各种各样的辅助工具（tmux、vim相关、make相关。tree的工具也不想装，直接写shell多方便），因为环境多变，如果突然没了插件可能会不知所措，喜欢最原始最朴素的命令和工具</p>
</blockquote>
</div></article></div></section><footer><div class="paginator"><a href="/2013/01/linux-file-directory-shell/" class="prev">上一篇</a><a href="/2013/01/2013-learning-plan/" class="next">下一篇</a></div><div data-thread-key="2013/01/linux-shell-term-tuning/" data-title="Shell常用命令 终端优化前篇" data-url="http://hongweiyi.com/2013/01/linux-shell-term-tuning/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"yihongwei"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>© 2015 - 2016 <a href="http://hongweiyi.com">Hongwei Yi</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-66911097-1",'auto');ga('send','pageview');</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>